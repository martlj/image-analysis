<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Thresholding</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #imageContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        img {
            max-height: 400px;
            margin: 0 20px;
        }
        #thresholdSlider {
            width: 50%;
            margin-bottom: 20px;
        }
        #pixelCount {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Image Thresholding</h1>
    <button id="loadButton">Load Image</button>
    <div id="imageOptions" style="display:none;">
        <label for="imageSelect">Choose an image:</label>
        <select id="imageSelect">
            <option value="images/1983.png">1983</option>
            <option value="images/2003.png">2003</option>
            <option value="images/2023.png">2023</option>
        </select>
    </div>
    <div id="imageContainer" style="display:none;">
        <div id="images">
            <img id="originalImage" src="" alt="Original Image">
            <img id="binaryImage" src="" alt="Binary Image">
        </div>
    </div>
    <input type="range" min="0" max="255" value="128" id="thresholdSlider">
    <div id="pixelCount">Pixel Count: 0</div>

    <script>
        const originalImage = document.getElementById('originalImage');
        const binaryImage = document.getElementById('binaryImage');
        const thresholdSlider = document.getElementById('thresholdSlider');
        const pixelCountDisplay = document.getElementById('pixelCount');
        const loadButton = document.getElementById('loadButton');
        const imageOptions = document.getElementById('imageOptions');
        const imageContainer = document.getElementById('imageContainer');

        let threshold = parseInt(thresholdSlider.value);

        // Function to update binary image based on threshold
        function updateBinaryImage() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const selectedImage = document.getElementById('imageSelect').value;
            const img = new Image();
            img.crossOrigin = 'Anonymous';
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;

                for (let i = 0; i < data.length; i += 4) {
                    const brightness = (data[i] + data[i + 1] + data[i + 2]) / 3;
                    const color = brightness > threshold ? 255 : 0;
                    data[i] = color;
                    data[i + 1] = color;
                    data[i + 2] = color;
                }

                ctx.putImageData(imageData, 0, 0);
                binaryImage.src = canvas.toDataURL();
                
                // Count "true" pixels
                let truePixelCount = 0;
                for (let i = 0; i < data.length; i += 4) {
                    if (data[i] === 255) {
                        truePixelCount++;
                    }
                }
                pixelCountDisplay.textContent = 'Pixel Count: ' + truePixelCount;
            };
            img.src = selectedImage;
            originalImage.src = selectedImage;
        }

        // Load the initial image
        loadButton.addEventListener('click', function() {
            loadButton.style.display = 'none';
            imageOptions.style.display = 'block';
        });

        // Update binary image when slider is moved
        thresholdSlider.addEventListener('input', function() {
            threshold = parseInt(thresholdSlider.value);
            updateBinaryImage();
        });

        // Update images when dropdown option is changed
        imageSelect.addEventListener('change', function() {
            updateBinaryImage();
            imageContainer.style.display = 'flex';
        });
    </script>
</body>
</html>
